# 🎯 CLAUDE.md 자동화 워크플로우 반영 방법

**상태:** 🟡 검토 중 | **긴급도:** 🟡 보통 | **날짜:** 2026-01-28

---

## 📌 한 줄 요약
> 자동화 흐름도(Hooks, pytest, CI)를 CLAUDE.md에 어떤 형태로 반영할지 결정

## 🔍 현재 상황

**핵심 문제:**
- 자동화 워크플로우(Stop Hook, PreToolUse, GitHub Actions)가 존재함
- 하지만 CLAUDE.md에는 언급이 없어 Claude가 매 세션 자동 인식 불가
- pre-implementation-review.md에만 흐름도 존재

**배경:**
- Boris Cherny(Claude Code 개발자): CLAUDE.md를 "Agent의 헌법"으로 사용
- 웹 검색 결과: "구체적 지침 > 프로세스 설명" 권장
- 현재 `.claude/settings.json`에 Hooks는 설정되어 있음 (동작 중)

**제약:**
- CLAUDE.md는 간결해야 함 (Boris: 2.5k 토큰 권장)
- 매 세션마다 자동 로드되므로 필수 정보만 포함
- 상세 문서는 이미 docs/에 존재

---

## ⚖️ 선택지 비교

| 선택지 | 장점 | 단점 | 토큰 비용 |
|--------|------|------|-----------|
| **A: 구체적 규칙만 명시** (추천) | - Claude가 즉시 인식<br>- DO/DON'T 형태로 명확<br>- 실행 가능한 명령어 포함 | - 흐름도 시각화 없음<br>- 초심자가 전체 그림 파악 어려움 | 🟢 +300 토큰 |
| **B: 흐름도 전체 복사** | - 한눈에 프로세스 파악<br>- 시각적으로 이해 쉬움 | - ASCII 흐름도가 토큰 낭비<br>- CLAUDE.md가 장황해짐<br>- 실행 가능한 지침 아님 | 🔴 +600 토큰 |
| **C: 파일 참조만 추가** | - CLAUDE.md 간결 유지<br>- 상세는 별도 문서에 | - Claude가 자동으로 파일을 못 열 수도<br>- 매번 참조 확인 필요 | 🟢 +50 토큰 |
| **D: 현재 유지 (반영 안함)** | - 아무 작업 불필요 | - Claude가 자동화 규칙 모름<br>- 매번 수동 설명 필요 | 🟢 ±0 토큰 |

---

## ❓ 결정 전 체크리스트

다음 질문에 답하면서 결정하세요:

- [x] **Claude가 "main 브랜치 차단" 규칙을 매 세션 자동 인식해야 하나요?**
  - Yes → A 또는 B 필요
  - No → C 또는 D 가능

- [ ] **Stop Hook에서 pytest가 실행된다는 것을 Claude가 알아야 하나요?**
  - Yes → A 또는 B 필요
  - No → C 또는 D 가능

- [ ] **CLAUDE.md가 장황해지는 것이 괜찮나요?**
  - Yes → B 가능
  - No → A 또는 C 추천

- [ ] **초심자(다른 개발자)가 프로젝트를 처음 접할 때 흐름도가 필요한가요?**
  - Yes → 흐름도는 README.md나 별도 문서에 유지
  - No → A만으로 충분

---

## 🎬 선택하기

> 👆 위 체크리스트 확인 후, 아래에서 선택:

- [x] **A 선택** (추천) - CLAUDE.md에 구체적 규칙만 추가 (DO/DON'T + 명령어)
  ```
  예시:
  ## Development Rules
  ### 🚫 절대 금지
  - main 브랜치에서 Edit/Write 금지 (PreToolUse Hook 자동 차단)

  ### ✅ 자동 실행
  - Stop Hook: ruff + pytest 자동 실행 (실패해도 차단 안됨)
  ```

- [ ] **B 선택** - 흐름도 전체를 CLAUDE.md에 복사
  ```
  자동화 흐름도 ASCII art를 CLAUDE.md에 그대로 추가
  ```

- [ ] **C 선택** - 파일 참조만 추가
  ```
  예시:
  ## 자동화 워크플로우
  상세 흐름도: @docs/pre-implementation-review.md (라인 480-521)
  ```

- [ ] **D 선택** - 현재 유지 (반영 안함)
  ```
  .claude/settings.json만으로 충분하다고 판단
  ```

---

## 💡 추천 이유 (A를 추천하는 이유)

1. **Boris Cherny 방식 일치**: "commands, workflows, conventions" 명시
2. **즉시 실행 가능**: 복사-붙여넣기로 명령어 실행
3. **매 세션 자동 인식**: 파일 참조 없이 바로 확인
4. **토큰 효율**: 300 토큰 추가로 핵심 규칙 전달
5. **확장 가능**: 나중에 규칙 추가/수정 쉬움

**흐름도는 어디에?**
- README.md의 "개발 워크플로우" 섹션에 추가 (신규 개발자용)
- pre-implementation-review.md에 유지 (상세 문서용)

---

## 📝 결정 기록 (결정 후 작성)

**최종 선택:** A - CLAUDE.md에 구체적 규칙만 추가

**선택 이유:**
- Claude가 매 세션 자동으로 규칙 인식 필요 (체크리스트 1, 2번 Yes)
- 간결 유지 (+300 토큰 이내) 원함 (체크리스트 3번)
- Boris Cherny 방식 일치: "DO/DON'T + 실행 가능한 명령어"

**구체적 액션:**
1. CLAUDE.md에 "Development Rules (자동화 강제 사항)" 섹션 추가
2. 🚫 절대 금지, ✅ 자동 실행, 📋 체크리스트 형태로 작성
3. 흐름도는 README.md "개발 워크플로우" 섹션에 별도 추가 (신규 개발자용)

**예상 결과:**
- Claude가 main 브랜치 보호 규칙 자동 인식 → 실수 방지
- Stop Hook pytest 실행 인지 → 작업 효율 증가
- CLAUDE.md 토큰: 1000 → 1300 (여유 범위)

**회고 날짜:** 2026-02-04 (1주 후)

